<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ipb.mapper.StoreAutoOrdersMapper">

    <!-- store_product_id로 store_auto_orders 전체를 가져온다. -->
    <select id="selectBySpi" parameterType="Long" resultType="StoreAutoOrders">
        SELECT * FROM store_auto_orders WHERE store_product_id = #{store_product_id}
    </select>

    <!-- 자동발주를 할 상품을 선택해서 자동발주테이블에 담기 -->
    <insert id="insert" parameterType="StoreAutoOrders">
        INSERT INTO store_auto_orders VALUES (NULL, #{qnt}, #{min_qnt}, #{store_product_id}, #{product_code})
    </insert>

    <!-- 자동발주 등록된 리스트 전체 불러오기 -->
    <select id="getAutoList" resultType="StoreAutoOrders">
        SELECT sao.*, sp.*
        FROM store_auto_orders sao
                 INNER JOIN store_product sp on sp.id = sao.store_product_id
        ORDER BY sp.store_id
    </select>

</mapper>
